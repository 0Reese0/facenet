(function(){var e={6076:function(){},4e3:function(e,t,a){"use strict";var s=a(8935),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},r=[],n=a(6076),o=a.n(n),l=o(),u=a(1001),d=(0,u.Z)(l,i,r,!1,null,null,null),c=d.exports,m=a(2809),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"login"}},[a("div",{staticClass:"body"},[e._m(0),a("el-card",{staticClass:"right"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("登录界面")])]),a("el-form",{ref:"userForm",staticStyle:{height:"100%"},attrs:{model:e.user,rules:e.userRules}},[a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("userForm")}}},[e._v("登录")])],1),a("el-form-item",[a("span",[e._v("没有账户?"),a("el-link",{attrs:{type:"primary",href:"/#/register"}},[e._v("注册")])],1)])],1)],1)],1)])},g=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"left"},[a("img",{attrs:{src:"https://als.sian.one/d/%E9%9F%B3%E5%BD%B1%E8%B5%84%E6%BA%90/%E5%9B%BE%E7%89%872022-3-8/ef9fb050e987252edbaafc97be4953aa.png",alt:""}})])}],p={data(){return{user:{phone:"",password:""},userRules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,message:"手机号格式不正确",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z_]{8,16}$/,message:" 要求：必须包含数字和字母，且长度要在8-16位之间。",trigger:"blur"}]}}},methods:{submitForm(e){this.$refs[e].validate((e=>{if(!e)return this.$message("请按要求填写表单"),!1;var t=this;this.axios({method:"POST",url:"/api/v1/users/login",headers:{"Content-Type":"multipart/form-data"},data:t.user}).then((e=>{200==e.data.code?(t.$message("登录成功"),t.$cookies.set("user",e.data.data),t.$cookies.set("token",e.data.msg),setTimeout((()=>{window.location.href="/#/main"}),1e3)):t.$message(e.data.msg)}))}))}}},v=p,f=(0,u.Z)(v,h,g,!1,null,"d127cff4",null),w=f.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"register"}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("注册")])]),a("el-steps",{attrs:{active:e.step+1,"align-center":""}},[a("el-step",{attrs:{title:"步骤1",description:"设置头像"}}),a("el-step",{attrs:{title:"步骤2",description:"设置账户密码"}}),a("el-step",{attrs:{title:"步骤3",description:"设置其他信息"}})],1),a("el-form",{ref:"userForm",staticStyle:{"margin-top":"10px"},attrs:{model:e.user,rules:e.userRules}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.step,expression:"step==0"}],staticStyle:{display:"flex","justify-content":"center","align-items":"center"}},[a("div",{staticClass:"avatarSelect"},[""!=e.avatarBase64?a("img",{staticClass:"avatar",staticStyle:{"object-fit":"cover",height:"100%",width:"100%"},attrs:{src:e.avatarBase64}}):a("span",{staticStyle:{width:"300px",height:"300px",display:"block","line-height":"300px","text-align":"center"}},[e._v("点击此处，上传本地头像")]),a("input",{ref:"avatarInput",staticStyle:{position:"absolute",left:"0",top:"0",display:"block",width:"100%",height:"100%",opacity:"0"},attrs:{type:"file",accept:".jpg,.jpeg,.png,.bmp"},on:{change:function(t){return e.uploadAvatar()}}})]),a("el-popover",{attrs:{placement:"top",width:"500",trigger:"manual"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticClass:"regCamera"},[a("video",{staticClass:"regVideo",attrs:{poster:"https://dummyimage.com/500x500/000/fff",muted:"",loop:"",playsinline:""},domProps:{muted:!0}}),a("canvas",{staticClass:"regCanvas"})]),a("div",{staticStyle:{"text-align":"right",margin:"10px"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.closeCamera()}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.takePhoto()}}},[e._v("拍照")])],1),a("el-button",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{slot:"reference"},on:{click:function(t){return e.openCamera()}},slot:"reference"},[e._v(" 调用摄像头拍照")])],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.step,expression:"step==1"}],attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入手机号"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.step,expression:"step==1"}],attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.step,expression:"step==1"}],attrs:{label:"确认密码",prop:"chkpwd"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入确认密码"},model:{value:e.user.chkpwd,callback:function(t){e.$set(e.user,"chkpwd",t)},expression:"user.chkpwd"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step==2"}],attrs:{label:"姓名",prop:"username"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入真实姓名"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step==2"}],attrs:{prop:"sex",label:"性别"}},[a("el-radio-group",{model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}},[a("el-radio-button",{attrs:{label:1}},[e._v("男")]),a("el-radio-button",{attrs:{label:0}},[e._v("女")])],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step==2"}],attrs:{prop:"age",label:"年龄"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入年龄"},model:{value:e.user.age,callback:function(t){e.$set(e.user,"age",t)},expression:"user.age"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step==2"}],attrs:{label:"地址",prop:"address"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入住址"},model:{value:e.user.address,callback:function(t){e.$set(e.user,"address",t)},expression:"user.address"}})],1),a("el-form-item",{staticStyle:{display:"flex","justify-content":"flex-end"}},[a("el-button-group",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-arrow-left",disabled:0==e.step},on:{click:function(t){e.step--}}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary",size:"small",disabled:2==e.step},on:{click:function(t){e.step++}}},[e._v("下一步"),a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step==2"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitForm("userForm")}}},[e._v("注册")])],1)],1)],1)],1)},y=[],k=(a(1703),a(2801),a(8675),a(3462),{data(){var e=(e,t,a)=>{""===t?a(new Error("请再次输入密码")):t!==this.user.password?a(new Error("两次输入密码不一致!")):a()};return{step:0,avatarName:"",avatarBase64:"",visible:!1,thisCanvas:null,thisVideo:null,constraints:{audio:!1,video:{width:500,height:500}},user:{phone:"",password:"",chkpwd:"",username:"",sex:"1",age:"18",address:"",avatar:""},userRules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,message:"手机号格式不正确",trigger:"blur"}],username:{required:!0,message:"请输入姓名",trigger:"blur"},password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z_]{8,16}$/,message:" 要求：必须包含数字和字母，且长度要在8-16位之间。",trigger:"blur"}],chkpwd:[{validator:e,trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"},{pattern:/^((1[0-5])|[1-9])?\d$/,message:"年龄不合法",trigger:"blur"}]}}},methods:{submitForm(e){var t=this;if(""==this.avatarBase64)return this.$message("用户头像不能为空");var a=this.base64ToFile(this.avatarBase64,this.avatarName);this.user.avatar=a,this.$refs[e].validate((e=>{if(!e)return this.$message("请按要求填写表单"),!1;this.axios({method:"POST",url:"/api/v1/users/reg",headers:{"Content-Type":"multipart/form-data"},data:{username:t.user.username,avatar:t.user.avatar,phone:t.user.phone,password:t.user.password,sex:t.user.sex,age:t.user.age,address:t.user.address}}).then((e=>{200==e.data.code?(t.$message("注册成功"),setTimeout((()=>{window.location.href="/#/login"}),1e3)):t.$message(e.data.msg)}))}))},uploadAvatar(){var e=this.$refs.avatarInput.files[0];if(null!=e){const t=5242880;if(e.size>t)return void this.$message("头像图片大小限制5M");this.avatarName=e.name,this.fileToBase64(e)}},fileToBase64(e){if(null!=e){var t=this,a=new FileReader;a.readAsDataURL(e),a.onloadend=function(e){t.avatarBase64=e.target.result}}},base64ToFile(e,t){let a=e.split(","),s=a[0].match(/:(.*?);/)[1],i=atob(a[1]),r=i.length,n=new Uint8Array(r);while(r--)n[r]=i.charCodeAt(r);return new File([n],t,{type:s})},fnInit(){this.thisVideo=document.getElementsByClassName("regVideo")[0],this.thisCanvas=document.getElementsByClassName("regCanvas")[0],this.thisCanvas.width=500,this.thisCanvas.height=500},fnOpen(){"object"!==typeof window.stream&&(clearTimeout(this.timeout),this.timeout=setTimeout((()=>{clearTimeout(this.timeout),navigator.mediaDevices.getUserMedia(this.constraints).then(this.fnSuccess).catch(this.fnError)}),300))},fnSuccess(e){window.stream=e,this.thisVideo.srcObject=e,this.thisVideo.play()},fnError(e){this.$message("摄像头调用错误"+e)},fnClose(){this.thisCanvas.getContext("2d").clearRect(0,0,this.thisCanvas.width,this.thisCanvas.height),this.thisVideo.pause(),clearTimeout(this.timeout),"object"===typeof window.stream&&(window.stream.getTracks().forEach((e=>e.stop())),window.stream="",this.thisVideo.srcObject=null)},openCamera(){this.visible=!0,this.fnInit(),this.fnOpen()},closeCamera(){this.visible=!1,this.fnClose()},takePhoto(){this.visible=!1,this.thisCanvas.getContext("2d").drawImage(this.thisVideo,0,0,500,500),this.avatarBase64=this.thisCanvas.toDataURL("image/png"),this.avatarName="face.png",this.fnClose()}},beforeDestroy(){this.fnClose()}}),x=k,_=(0,u.Z)(x,b,y,!1,null,"0be2c686",null),$=_.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticStyle:{height:"100vh"}},[a("el-container",[a("el-header",{staticStyle:{"background-color":"#606266",display:"flex",color:"#F2F6FC","font-size":"14px"}},[a("div",{staticStyle:{"font-size":"20px"}},[e._v("会议签到")]),a("span",{staticStyle:{flex:"1"}}),a("el-dropdown",[a("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px",color:"#F2F6FC"}}),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){e.$router.push("/main/").catch((function(e){}))}}},[e._v("首页")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.goAdmin()}}},[e._v("后台管理")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.$router.push("/main/userInfo").catch((function(e){}))}}},[e._v("个人信息")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.logout()}}},[e._v("退出登录")])],1)],1),a("span",[e._v(e._s(e.user.username))])],1),a("el-main",[a("router-tab",{attrs:{"page-transition":"page-fade","tab-transition":"tab-scale","keep-alive":!1,dragsort:!1,tabs:["/main/"]},scopedSlots:e._u([{key:"start",fn:function(){return[a("router-link",{attrs:{to:"/main/"}},[a("i",{staticClass:"el-icon-s-home router-tab__item",staticStyle:{display:"block",height:"40px","line-height":"40px",padding:"0 10px","box-sizing":"border-box"}})])]},proxy:!0}])})],1)],1)],1)},C=[],I={data(){return{user:""}},methods:{goAdmin(){this.$router.push("/admin").catch((e=>{}))},logout(){this.$cookies.remove("user"),this.$cookies.remove("token"),window.location.href="/#/login"}},mounted(){this.user=this.$cookies.get("user")}},T=I,N=(0,u.Z)(T,S,C,!1,null,"e6461c72",null),M=N.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.meetings,height:e.tableHeight}},[a("el-table-column",{attrs:{prop:"mId",label:"会议ID",width:"70","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"meeting.title",label:"会议标题","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"user.username",label:"会议创建人","show-overflow-tooltip":"",width:"100"}}),a("el-table-column",{attrs:{prop:"meeting.state",label:"会议状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{staticStyle:{"user-select":"none"},attrs:{effect:"dark",type:e.meetingState[t.row.meeting.state],size:"mini"}},[e._v(" "+e._s(0==t.row.meeting.state?"未开始":1==t.row.meeting.state?"进行中":"已结束")+" ")])]}}])}),a("el-table-column",{attrs:{label:"签到状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"primary",size:"mini",effect:"dark"}},[e._v(" "+e._s(null==t.row.regTime?"未签到":"已签到")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"meeting.startTime",label:"会议开始时间","sort-orders":["ascending","descending",null],sortable:"","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getTime(t.row.meeting.startTime)))]}}])}),a("el-table-column",{attrs:{prop:"meeting.endTime",label:"会议预计结束时间","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getTime(t.row.meeting.endTime)))]}}])}),a("el-table-column",{attrs:{prop:"meeting.createTime",label:"会议创建时间","sort-orders":["ascending","descending",null],sortable:"","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getTime(t.row.meeting.createTime)))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",disabled:1!=t.row.meeting.state||null!=t.row.regTime},on:{click:function(a){return e.goSingInMeeting(t.row)}}},[e._v("签到")])]}}])})],1)],1)},D=[],P={data(){return{searchParames:{meetingTitle:"",meetingState:"",meetingUserName:"",meetingSingState:""},loading:!0,meetingState:["","success","info"],meetings:[],tableHeight:document.body.clientHeight-200,meetingStates:[{name:"未开始",value:0},{name:"进行中",value:1},{name:"已结束",value:2}],meetingStates:[{name:"未签到",value:0},{name:"已签到",value:1}]}},async created(){setTimeout((()=>{this.loading=!1}),500);var e=this;window.onresize=function(){e.tableHeight=document.body.clientHeight-200},await this.axios({method:"get",url:"api/v1/meeting_history/findByuId",headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?e.meetings=t.data.data:e.$message(t.data.msg)}))},methods:{goSingInMeeting(e){this.$router.push({name:"singInMeeting",params:{meeting:e}})},getTime(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),r=t.getHours()+"";1==r.length&&(r="0"+r);var n=t.getMinutes()+"";1==n.length&&(n="0"+n);var o=t.getSeconds()+"";return 1==o.length&&(o="0"+o),a+"年"+s+"月"+i+"日 "+r+":"+n+":"+o}}},z=P,E=(0,u.Z)(z,F,D,!1,null,"1a2c03f5",null),B=E.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"searchView"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.$router.push("/main/addMeeting").catch((function(e){}))}}},[e._v("创建会议")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.meetings,height:e.tableHeight}},[a("el-table-column",{attrs:{prop:"mId",label:"会议ID",width:"70","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"title",label:"会议标题","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"会议创建人",width:"100","show-overflow-tooltip":""}},[e._v(" "+e._s(e.$cookies.get("user").username)+" ")]),a("el-table-column",{attrs:{prop:"state",label:"会议状态","sort-orders":["ascending","descending",null],sortable:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{staticStyle:{"user-select":"none"},attrs:{effect:"dark",type:e.meetingState[t.row.state],size:"mini"}},[e._v(" "+e._s(0==t.row.state?"未开始":1==t.row.state?"进行中":"已结束")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"startTime",label:"会议开始时间","show-overflow-tooltip":"","sort-orders":["ascending","descending",null],sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getTime(t.row.startTime)))]}}])}),a("el-table-column",{attrs:{prop:"endTime",label:"会议预计结束时间","show-overflow-tooltip":"","sort-orders":["ascending","descending",null],sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getTime(t.row.endTime)))]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"会议创建时间","show-overflow-tooltip":"","sort-orders":["ascending","descending",null],sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getTime(t.row.createTime)))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary",disabled:2!=t.row.state},on:{click:function(a){return e.goStatisticalMeeting(t.row)}}},[e._v("统计")]),a("el-button",{attrs:{size:"mini",type:"primary",disabled:2==t.row.state},on:{click:function(a){return e.goManagerMeeting(t.row)}}},[e._v("管理")]),a("el-button",{attrs:{size:"mini",type:"danger",disabled:1!=t.row.state},on:{click:function(a){return e.endMeeting(t.row)}}},[e._v(" 结束会议")]),a("el-button",{attrs:{size:"mini",type:"danger",disabled:1==t.row.state},on:{click:function(a){return e.delMeeting(t.row)}}},[e._v(" 删除 ")])]}}])})],1)],1)},U=[],A={data(){return{searchParames:{meetingTitle:"",meetingState:"",meetingUserName:"",meetingSingState:""},loading:!0,meetingState:["","success","info"],meetings:[],tableHeight:document.body.clientHeight-200,meetingStates:[{name:"未开始",value:0},{name:"进行中",value:1},{name:"已结束",value:2}],meetingStates:[{name:"未签到",value:0},{name:"已签到",value:1}]}},async created(){setTimeout((()=>{this.loading=!1}),500);var e=this;await this.axios({methods:"GET",url:"/api/v1/meeting/findSelfAll",headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?e.meetings=t.data.data:e.$message(t.data.msg)}));e=this;window.onresize=function(){e.tableHeight=document.body.clientHeight-200}},methods:{endMeeting(e){var t=this;this.$confirm("此操作将结束该会议, 是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"error"}).then((()=>{t.axios({method:"post",url:"/api/v1/meeting/endMeeting",headers:{"Content-Type":"multipart/form-data",token:t.$cookies.get("token")},data:{mId:e.mId}}).then((e=>{200==e.data.code?(t.$message("结束会议"),this.$tabs.refresh()):t.$message(e.data.msg)}))})).catch((()=>{}))},goManagerMeeting(e){this.$router.push({name:"managerMeeting",params:{meeting:e}})},goStatisticalMeeting(e){this.$cookies.set("meeting",e),this.$router.push({name:"statisticalMeeting",params:{meeting:e}})},delMeeting(e){var t=this;this.$confirm("此操作将永久删除该会议, 是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"error"}).then((()=>{t.axios({method:"post",url:"/api/v1/meeting/deleteBymId",headers:{"Content-Type":"multipart/form-data",token:t.$cookies.get("token")},data:{mId:e.mId}}).then((e=>{200==e.data.code?(t.$message("删除成功"),this.$tabs.refresh()):t.$message(e.data.msg)}))})).catch((()=>{}))},getTime(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),r=t.getHours()+"";1==r.length&&(r="0"+r);var n=t.getMinutes()+"";1==n.length&&(n="0"+n);var o=t.getSeconds()+"";return 1==o.length&&(o="0"+o),a+"年"+s+"月"+i+"日 "+r+":"+n+":"+o}}},j=A,V=(0,u.Z)(j,O,U,!1,null,"d0eefeea",null),R=V.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{directives:[{name:"show",rawName:"v-show",value:0==e.active,expression:"active==0"}],ref:"meetingForm",staticStyle:{width:"400px",margin:"0 auto","margin-top":"20px"},attrs:{model:e.createMeetingData,rules:e.rules}},[a("el-form-item",{attrs:{prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入会议主题"},model:{value:e.createMeetingData.title,callback:function(t){e.$set(e.createMeetingData,"title",t)},expression:"createMeetingData.title"}})],1),a("el-form-item",{attrs:{prop:"datetime"}},[a("el-date-picker",{attrs:{"time-arrow-control":"","value-format":"timestamp",type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间","default-time":["08:00:00"]},model:{value:e.createMeetingData.datetime,callback:function(t){e.$set(e.createMeetingData,"datetime",t)},expression:"createMeetingData.datetime"}})],1),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("meetingForm")}}},[e._v("创建会议")])],1)],1),a("el-result",{directives:[{name:"show",rawName:"v-show",value:1==e.active,expression:"active==1"}],attrs:{icon:"success",title:"创建会议成功",subTitle:e.msg}},[a("template",{slot:"extra"},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.$tabs.close({to:"/main/createMeetings"})}}},[e._v("我创建的会议 ")])],1)],2),a("el-result",{directives:[{name:"show",rawName:"v-show",value:2==e.active,expression:"active==2"}],attrs:{icon:"error",title:"创建会议失败",subTitle:e.msg}},[a("template",{slot:"extra"},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.$tabs.open("/main/addMeeting")}}},[e._v("重新创建会议")])],1)],2)],1)},Z=[],q={data(){return{msg:"在 <<我创建的会议>> 里管理会议,进行添加人员",active:0,createMeetingData:{datetime:"",title:""},rules:{datetime:{required:!0,message:"请选择会议时间",trigger:"blur"},title:{required:!0,message:"请输入会议名称",trigger:"blur"}}}},methods:{submitForm(e){this.$refs[e].validate((e=>{if(!e)return this.$message("请按要求填写表单"),this.active=2,!1;var t=this;this.axios({method:"POST",url:"/api/v1/meeting/insert",headers:{"Content-Type":"multipart/form-data",token:t.$cookies.get("token")},data:{title:t.createMeetingData.title,startTime:t.createMeetingData.datetime[0],endTime:t.createMeetingData.datetime[1]}}).then((e=>{200==e.data.code&&(this.$message("会议创建成功"),this.active=1)}))}))}},beforePageLeave(e,t){if(""===this.createMeetingData.datetime&&""===this.createMeetingData.title)return;if(1==this.active)return;if("unload"===t)return`您在“${e.title}”页签的更改尚未完成，是否要离开？`;const a={close:"关闭",refresh:"刷新",replace:"替换",leave:"离开"}[t],s=`您确认要${a}页签“${e.title}”吗？`;return new Promise(((e,t)=>{confirm(s)&&e()}))}},J=q,L=(0,u.Z)(J,H,Z,!1,null,null,null),G=L.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{margin:"20px 20px 20px 0"},attrs:{type:"primary",icon:"el-icon-check"},on:{click:function(t){return e.submitForm("meetingForm")}}},[e._v("保存")]),a("el-button-group",[a("el-radio-group",{staticStyle:{margin:"20px 0px"},model:{value:e.flag,callback:function(t){e.flag=t},expression:"flag"}},[a("el-radio-button",{attrs:{label:0}},[e._v("修改会议信息")]),a("el-radio-button",{attrs:{label:1}},[e._v("编辑会议成员")])],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0==e.flag,expression:"flag==0"}],ref:"meetingForm",staticStyle:{width:"400px"},attrs:{model:e.createMeetingData,rules:e.rules}},[a("el-form-item",{attrs:{prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入会议主题"},model:{value:e.createMeetingData.title,callback:function(t){e.$set(e.createMeetingData,"title",t)},expression:"createMeetingData.title"}})],1),a("el-form-item",{attrs:{prop:"datetime"}},[a("el-date-picker",{attrs:{"time-arrow-control":"","value-format":"timestamp",type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间","default-time":["08:00:00"]},model:{value:e.createMeetingData.datetime,callback:function(t){e.$set(e.createMeetingData,"datetime",t)},expression:"createMeetingData.datetime"}})],1)],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:1==e.flag,expression:"flag==1"}],ref:"users",attrs:{data:e.users,"tooltip-effect":"dark",height:e.tableHeight},on:{"selection-change":e.UserSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"avatar",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.avatar,fit:"cover"}})]}}])}),a("el-table-column",{attrs:{prop:"username",label:"姓名"}}),a("el-table-column",{attrs:{prop:"age",label:"年龄"}}),a("el-table-column",{attrs:{prop:"sex",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(0==t.row.sex?"女":"男"))])]}}])}),a("el-table-column",{attrs:{prop:"phone",label:"手机号","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"address",label:"地址","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"admin",label:"权限"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(0==t.row.admin?"普通用户":"管理员"))])]}}])}),a("el-table-column",{attrs:{prop:"audit",label:"账户状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(0==t.row.audit?"未审核":"已审核"))])]}}])})],1)],1)},X=[],K={data(){return{tableHeight:document.body.clientHeight-222,flag:0,createMeetingData:{datetime:"",title:"",mId:"",state:""},rules:{datetime:{required:!0,message:"请选择会议时间",trigger:"blur"},title:{required:!0,message:"请输入会议名称",trigger:"blur"}},users:[],selectUsers:[]}},async created(){var e=new Array;e.push(this.$route.params.meeting.startTime),e.push(this.$route.params.meeting.endTime),this.createMeetingData.datetime=e,this.createMeetingData.title=this.$route.params.meeting.title,this.createMeetingData.mId=this.$route.params.meeting.mId,this.createMeetingData.state=this.$route.params.meeting.state,console.log(this.$route.params.meeting);var t=this;window.onresize=function(){t.tableHeight=document.body.clientHeight-222},await this.axios({method:"GET",url:"api/v1/users/findUserList",headers:{token:t.$cookies.get("token")}}).then((e=>{t.users=e.data.data})),await this.axios({method:"GET",url:"/api/v1/meeting_history/findBymId?mId="+t.createMeetingData.mId,headers:{"Content-Type":"multipart/form-data",token:t.$cookies.get("token")}}).then((e=>{for(var a=e.data.data,s=0;s<t.users.length;s++)for(var i=0;i<a.length;i++)a[i].uId==t.users[s].uId&&t.$refs.users.toggleRowSelection(t.users[s])}))},methods:{submitForm(e){this.$refs[e].validate((e=>{var t=this;if(0==this.flag){if(!e)return this.$message("请按要求填写表单"),!1;t.axios({method:"POST",url:"/api/v1/meeting/updateBymID",headers:{"Content-Type":"multipart/form-data",token:t.$cookies.get("token")},data:{title:t.createMeetingData.title,startTime:t.createMeetingData.datetime[0],endTime:t.createMeetingData.datetime[1],mId:t.createMeetingData.mId}}).then((e=>{200==e.data.code?t.$message("会议信息修改成功"):t.$message(e.data.msg)}))}else{for(var a=[],s=0;s<t.selectUsers.length;s++)a.push(t.selectUsers[s].uId);this.axios({method:"POST",url:"/api/v1/meeting_history/insert",headers:{"Content-Type":"multipart/form-data",token:t.$cookies.get("token")},data:{mId:t.createMeetingData.mId,ids:a.toString()}}).then((e=>{200==e.data.code?t.$message("完成"):t.$message(e.data.msg)}))}}))},UserSelectionChange(e){this.selectUsers=e}},beforePageLeave(e,t){if(""===this.createMeetingData.datetime&&""===this.createMeetingData.title)return;if(1==this.active)return;if("unload"===t)return`您在“${e.title}”页签的更改尚未完成，是否要离开？`;const a={close:"关闭",refresh:"刷新",replace:"替换",leave:"离开"}[t],s=`您确认要${a}页签“${e.title}”吗？`;return new Promise(((e,t)=>{confirm(s)&&(this.$tabs.close(),e())}))}},Q=K,W=(0,u.Z)(Q,Y,X,!1,null,null,null),ee=W.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"webrtc_face_detector"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.singFlag,expression:"singFlag"}],attrs:{type:"primary"},on:{click:function(t){return e.reCheckFace()}}},[e._v("人脸签到")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.singFlag,expression:"singFlag"}],attrs:{type:"primary"},on:{click:function(t){return e.reSingIn()}}},[e._v("手动签到")]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.singFlag,expression:"!singFlag"}],staticClass:"singInCamera"},[a("video",{staticClass:"singInVideo",attrs:{poster:"https://dummyimage.com/720x720/000/fff",muted:"",loop:"",playsinline:""},domProps:{muted:!0},on:{loadedmetadata:function(t){return e.fnRun()}}}),a("canvas",{staticClass:"singInCanvas"})])],1)},ae=[],se=a(4889),ie={data(){return{base64:"",singFlag:!1,singing:!1,options:null,singInVideo:null,singInCanvas:null,timeout:0,constraints:{audio:!1,video:{width:720,height:720}}}},created(){this.fnInit(),this.fnOpen()},methods:{async fnInit(){await se.qB.mtcnn.loadFromUri("/models"),this.options=new se.UI({maxNumScales:1,scaleFactor:0,minFaceSize:250}),this.singInVideo=document.getElementsByClassName("singInVideo")[0],this.singInCanvas=document.getElementsByClassName("singInCanvas")[0],this.singInCanvas.width=720,this.singInCanvas.height=720},async fnRun(){var e=this;const t=await se.bd(this.singInVideo,this.options);if(t&&!this.singInVideo.paused){e.singInCanvas.getContext("2d").drawImage(e.singInVideo,0,0,720,720),this.singing||(this.singing=!0,this.singIn(e.singInCanvas.toDataURL("image/png")));const a=se.JF(this.singInCanvas,this.singInVideo,!0),s=se._C(t,a);se.ii.drawDetections(this.singInCanvas,s)}else this.singInCanvas.getContext("2d").clearRect(0,0,this.singInCanvas.width,this.singInCanvas.height);this.timeout=setTimeout((()=>this.fnRun()))},fnOpen(){"object"!==typeof window.stream&&(clearTimeout(this.timeout),this.timeout=setTimeout((()=>{clearTimeout(this.timeout),navigator.mediaDevices.getUserMedia(this.constraints).then(this.fnSuccess).catch(this.fnError)}),300))},fnSuccess(e){window.stream=e,this.singInVideo.srcObject=e,this.singInVideo.play()},fnError(e){this.$message("摄像头调用错误"+e)},fnClose(){this.singInCanvas.getContext("2d").clearRect(0,0,this.singInCanvas.width,this.singInCanvas.height),this.singInVideo.pause(),clearTimeout(this.timeout),"object"===typeof window.stream&&(window.stream.getTracks().forEach((e=>e.stop())),window.stream="",this.singInVideo.srcObject=null)},singIn(e){var t=this.base64ToFile(e,"face.png");console.log(e),this.$message("识别到人脸，正在进行签到...");var a=this.$route.params.meeting,s=this;this.axios({method:"POST",url:"/api/v1/users/checkFace",headers:{"Content-Type":"multipart/form-data",token:s.$cookies.get("token")},data:{mId:a.mId,avatars:t}}).then((e=>{200==e.data.code?(s.$message("会议签到成功"),s.$tabs.close()):(this.singFlag=!0,this.singing=!1,this.fnClose(),this.$message(e.data.msg))}))},base64ToFile(e,t){let a=e.split(","),s=a[0].match(/:(.*?);/)[1],i=atob(a[1]),r=i.length,n=new Uint8Array(r);while(r--)n[r]=i.charCodeAt(r);return new File([n],t,{type:s})},reCheckFace(){this.fnInit(),this.fnOpen(),this.singFlag=!1,this.singing=!1},reSingIn(){var e=this,t=this.$route.params.meeting;this.axios({method:"POST",url:"/api/v1/users/singIn",headers:{"Content-Type":"multipart/form-data",token:e.$cookies.get("token")},data:{mId:t.mId}}).then((e=>{200==e.data.code?(this.$message("会议签到成功"),this.$tabs.close()):(this.singFlag=!0,this.singing=!1,this.$message(e.data.msg))}))}},beforeDestroy(){this.fnClose()}},re=ie,ne=(0,u.Z)(re,te,ae,!1,null,"03901c33",null),oe=ne.exports,le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"register"}},[a("el-radio-group",{staticStyle:{margin:"10px 10px 10px 0"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[a("el-radio-button",{attrs:{label:0}},[e._v("修改信息")]),a("el-radio-button",{attrs:{label:1}},[e._v("修改头像")]),a("el-radio-button",{attrs:{label:2}},[e._v("修改密码")])],1),a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.save()}}},[e._v("保存"+e._s(0==e.active?"信息":1==e.active?"头像":"密码")+" ")]),a("el-card",[a("el-form",{directives:[{name:"show",rawName:"v-show",value:0==e.active,expression:"active==0"}],ref:"userInfo",attrs:{model:e.user,rules:e.userRules}},[a("el-form-item",{attrs:{label:"姓名",prop:"username"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入真实姓名"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入手机号",disabled:""},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),a("el-form-item",{attrs:{prop:"sex",label:"性别"}},[a("el-radio-group",{model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("男")]),a("el-radio-button",{attrs:{label:"0"}},[e._v("女")])],1)],1),a("el-form-item",{attrs:{prop:"age",label:"年龄"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入年龄"},model:{value:e.user.age,callback:function(t){e.$set(e.user,"age",t)},expression:"user.age"}})],1),a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入住址"},model:{value:e.user.address,callback:function(t){e.$set(e.user,"address",t)},expression:"user.address"}})],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:2==e.active,expression:"active==2"}],ref:"changePwd",attrs:{model:e.changePwd,rules:e.changePwdRules}},[a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入密码"},model:{value:e.changePwd.password,callback:function(t){e.$set(e.changePwd,"password",t)},expression:"changePwd.password"}})],1),a("el-form-item",{attrs:{label:"确认密码",prop:"chkpwd"}},[a("el-input",{attrs:{type:"text",placeholder:"请确认密码"},model:{value:e.changePwd.chkpwd,callback:function(t){e.$set(e.changePwd,"chkpwd",t)},expression:"changePwd.chkpwd"}})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.active,expression:"active==1"}],staticStyle:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column"}},[a("div",{staticClass:"avatarSelect"},[""!=e.avatarBase64?a("img",{staticClass:"avatar",staticStyle:{"object-fit":"cover",height:"100%",width:"100%"},attrs:{src:e.avatarBase64}}):a("span",{staticStyle:{width:"300px",height:"300px",display:"block","line-height":"300px","text-align":"center"}},[e._v("点击此处，上传本地头像")]),a("input",{ref:"avatarInput",staticStyle:{position:"absolute",left:"0",top:"0",display:"block",width:"100%",height:"100%",opacity:"0"},attrs:{type:"file",accept:".jpg,.jpeg,.png,.bmp"},on:{change:function(t){return e.uploadAvatar()}}})]),a("el-popover",{attrs:{placement:"top",width:"500",trigger:"manual"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticClass:"updateUserInfoCamera"},[a("video",{staticClass:"updateUserInfoVideo",attrs:{poster:"https://dummyimage.com/500x500/000/fff",muted:"",loop:"",playsinline:""},domProps:{muted:!0}}),a("canvas",{staticClass:"updateUserInfoCanvas"})]),a("div",{staticStyle:{"text-align":"right",margin:"10px"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.closeCamera()}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.takePhoto()}}},[e._v("拍照")])],1),a("el-button",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{slot:"reference"},on:{click:function(t){return e.openCamera()}},slot:"reference"},[e._v(" 调用摄像头拍照")])],1)],1)],1)],1)},ue=[],de={data(){var e=(e,t,a)=>{""===t?a(new Error("请再次输入密码")):t!==this.changePwd.password?a(new Error("两次输入密码不一致!")):a()};return{avatarName:"",avatarBase64:"",visible:!1,thisCanvas:null,thisVideo:null,constraints:{audio:!1,video:{width:500,height:500}},active:0,changePwd:{password:"",chkpwd:""},changePwdRules:{password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z_]{8,16}$/,message:" 要求：必须包含数字和字母，且长度要在8-16位之间。",trigger:"blur"}],chkpwd:[{validator:e,trigger:"blur"}]},user:{phone:"",username:"",sex:1,age:"",address:"",avatar:""},userRules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,message:"手机号格式不正确",trigger:"blur"}],username:{required:!0,message:"请输入姓名",trigger:"blur"},age:[{required:!0,message:"请输入年龄",trigger:"blur"},{pattern:/^((1[0-5])|[1-9])?\d$/,message:"年龄不合法",trigger:"blur"}]}}},methods:{save(){0==this.active?this.saveUserInfo():1==this.active?this.saveAvatar():this.savePassword()},saveUserInfo(){this.$refs["userInfo"].validate((e=>{var t=this;e?this.axios({method:"POST",url:"api/v1/users/updateUserInfo",headers:{token:t.$cookies.get("token")},data:{username:t.user.username,age:t.user.age,address:t.user.address,sex:t.user.sex}}).then((e=>{if(200==e.data.code){var a=this.$cookies.get("user");a.username=t.user.username,a.age=t.user.age,a.address=t.user.address,a.sex=t.user.sex,this.$cookies.set("user",a),window.location.reload(),this.$message("修改成功")}else t.$message(e.data.msg)})):this.$message("请按要求填写信息")}))},saveAvatar(){var e=this;if(this.$cookies.get("user").avatar==this.avatarBase64)this.$message("未修改头像文件");else{var t=this.base64ToFile(this.avatarBase64,this.avatarName);this.axios({method:"POST",url:"api/v1/users/updateAvatar",headers:{"Content-Type":"multipart/form-data",token:e.$cookies.get("token")},data:{avatar:t}}).then((t=>{if(200==t.data.code){this.$cookies.get("user");this.$message("修改成功")}else e.$message(t.data.msg)}))}},savePassword(){this.$refs["changePwd"].validate((e=>{var t=this;e?this.axios({method:"POST",url:"api/v1/users/updatePassword",headers:{token:t.$cookies.get("token")},data:{password:t.changePwd.password}}).then((e=>{200==e.data.code?(this.$cookies.remove("user"),this.$cookies.remove("token"),window.location.href="/#/login"):t.$message(e.data.msg)})):this.$message("请按要求填写信息")}))},uploadAvatar(){var e=this.$refs.avatarInput.files[0];if(null!=e){const t=5242880;if(e.size>t)return void this.$message("头像图片大小限制5M");this.avatarName=e.name,this.fileToBase64(e)}},fileToBase64(e){if(null!=e){var t=this,a=new FileReader;a.readAsDataURL(e),a.onloadend=function(e){t.avatarBase64=e.target.result}}},base64ToFile(e,t){let a=e.split(","),s=a[0].match(/:(.*?);/)[1],i=atob(a[1]),r=i.length,n=new Uint8Array(r);while(r--)n[r]=i.charCodeAt(r);return new File([n],t,{type:s})},fnInit(){this.thisVideo=document.getElementsByClassName("updateUserInfoVideo")[0],this.thisCanvas=document.getElementsByClassName("updateUserInfoCanvas")[0],this.thisCanvas.width=500,this.thisCanvas.height=500},fnOpen(){"object"!==typeof window.stream&&(clearTimeout(this.timeout),this.timeout=setTimeout((()=>{clearTimeout(this.timeout),navigator.mediaDevices.getUserMedia(this.constraints).then(this.fnSuccess).catch(this.fnError)}),300))},fnSuccess(e){window.stream=e,this.thisVideo.srcObject=e,this.thisVideo.play()},fnError(e){this.$message("摄像头调用错误"+e)},fnClose(){this.thisCanvas.getContext("2d").clearRect(0,0,this.thisCanvas.width,this.thisCanvas.height),this.thisVideo.pause(),clearTimeout(this.timeout),"object"===typeof window.stream&&(window.stream.getTracks().forEach((e=>e.stop())),window.stream="",this.thisVideo.srcObject=null)},openCamera(){this.visible=!0,this.fnInit(),this.fnOpen()},closeCamera(){this.visible=!1,this.fnClose()},takePhoto(){this.visible=!1,this.thisCanvas.getContext("2d").drawImage(this.thisVideo,0,0,500,500),this.avatarBase64=this.thisCanvas.toDataURL("image/png"),this.avatarName="face.png",this.fnClose()}},created(){this.user=this.$cookies.get("user"),this.avatarBase64=this.user.avatar}},ce=de,me=(0,u.Z)(ce,le,ue,!1,null,"aaaa0f38",null),he=me.exports,ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column"},attrs:{id:"allPanel"}},[a("div",{staticClass:"el-card-g"},[a("el-card",{staticStyle:{"margin-right":"5px"},attrs:{shadow:"hover"}},[a("div",{staticStyle:{display:"flex"},attrs:{slot:"header"},slot:"header"},[e._v(" 参与的会议 "),a("span",{staticStyle:{flex:"1"}}),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.$router.push("/main/joinMeetings")}}},[e._v("查看")])],1),a("div",{staticClass:"el-card-item"},[a("div",{staticClass:"myJoinMeetingPic",staticStyle:{width:"100%",height:"300px"}})])]),a("el-card",{staticStyle:{"margin-left":"5px"},attrs:{shadow:"hover"}},[a("div",{staticStyle:{display:"flex"},attrs:{slot:"header"},slot:"header"},[e._v(" 创建的会议 "),a("span",{staticStyle:{flex:"1"}}),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.$router.push("/main/createMeetings")}}},[e._v("查看")])],1),a("div",{staticClass:"el-card-item"},[a("div",{staticClass:"myCreateMeetingPic",staticStyle:{width:"100%",height:"300px"}})])])],1)])},pe=[],ve=a(727),fe={data(){return{meetings:[],myJoinNum:{noStartNum:0,doingNum:0,endNum:0,noSingInNum:0},myCreateNum:{noStartNum:0,doingNum:0,endNum:0}}},async mounted(){var e=this;await this.axios({method:"get",url:"api/v1/meeting_history/findByuId",headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?e.meetings=t.data.data:e.$message(t.data.msg)}));for(var t=0;t<this.meetings.length;t++)null==this.meetings[t].regTime&&this.myJoinNum.noSingInNum++,0!=this.meetings[t].meeting.state?1!=this.meetings[t].meeting.state?2!=this.meetings[t].meeting.state||this.myJoinNum.endNum++:this.myJoinNum.doingNum++:this.myJoinNum.noStartNum++;var a=["未开始","进行中","已结束","未签到"],s=[this.myJoinNum.noStartNum,this.myJoinNum.doingNum,this.myJoinNum.endNum,this.myJoinNum.noSingInNum];this.create("myJoinMeetingPic",a,s);e=this;await this.axios({methods:"GET",url:"/api/v1/meeting/findSelfAll",headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?e.meetings=t.data.data:e.$message(t.data.msg)}));for(t=0;t<this.meetings.length;t++)0!=this.meetings[t].state?1!=this.meetings[t].state?2!=this.meetings[t].state||this.myCreateNum.endNum++:this.myCreateNum.doingNum++:this.myCreateNum.noStartNum++;a=["未开始","进行中","已结束"],s=[this.myCreateNum.noStartNum,this.myCreateNum.doingNum,this.myCreateNum.endNum];this.create("myCreateMeetingPic",a,s)},methods:{create(e,t,a){var s=ve.S1(document.getElementsByClassName(e)[0]);s.setOption({xAxis:{type:"category",data:t},yAxis:{type:"value"},series:[{data:a,type:"bar"}]})}}},we=fe,be=(0,u.Z)(we,ge,pe,!1,null,"3eb732cc",null),ye=be.exports,ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticStyle:{margin:"10px 0"},attrs:{shadow:"never"}},[a("span",[e._v("会议标题："+e._s(e.meeting.title))]),a("br"),a("br"),a("span",[e._v("会议创建人："+e._s(e.$cookies.get("user").username))]),a("br"),a("br"),a("span",[e._v("会议创建时间："+e._s(e.getTime(e.meeting.createTime)))]),a("br"),a("br"),a("span",[e._v("会议开始时间："+e._s(e.getTime(e.meeting.startTime)))]),a("br"),a("br"),a("span",[e._v("会议结束时间："+e._s(e.getTime(e.meeting.endTime)))]),a("br"),a("br"),a("span",[e._v("会议状态： "),a("el-tag",[e._v(e._s(0==e.meeting.state?"未开始":1==e.meeting.state?"进行中":"已结束"))])],1)]),a("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},[a("el-card",{staticStyle:{flex:"1","margin-right":"5px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("会议总人数")]),a("div",[a("h2",[e._v(e._s(e.count))])])]),a("el-card",{staticStyle:{flex:"1","margin-left":"5px","margin-right":"5px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("会议签到人数")]),a("div",[a("h2",[e._v(e._s(e.singInNum))])])]),a("el-card",{staticStyle:{flex:"1","margin-left":"5px","margin-right":"5px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("人脸签到人数")]),a("div",[a("h2",[e._v(e._s(e.faceSingInNum))])])]),a("el-card",{staticStyle:{flex:"1","margin-left":"5px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("手动签到人数")]),a("div",[a("h2",[e._v(e._s(e.defaultSingInNum))])])])],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"meetingSingType",staticStyle:{height:"300px"}})]),a("el-card",{staticStyle:{"margin-top":"10px"}},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("参会人员列表")]),a("el-table",{ref:"users",attrs:{data:e.users,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"user.avatar",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.user.avatar,fit:"cover"}})]}}])}),a("el-table-column",{attrs:{prop:"user.username",label:"姓名"}}),a("el-table-column",{attrs:{prop:"user.age",label:"年龄"}}),a("el-table-column",{attrs:{prop:"user.sex",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(0==t.row.user.sex?"女":"男"))])]}}])}),a("el-table-column",{attrs:{prop:"user.phone",label:"手机号","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"user.address",label:"地址","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"admin",label:"权限"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(0==t.row.admin?"普通用户":"管理员"))])]}}])}),a("el-table-column",{attrs:{prop:"user.audit",label:"账户状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(0==t.row.audit?"未审核":"已审核"))])]}}])}),a("el-table-column",{attrs:{prop:"regTime",label:"签到状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(null==t.row.regTime?"未签到":"已签到"))])]}}])})],1)],1)],1)},xe=[],_e={data(){return{count:0,singInNum:0,noSingInNum:0,faceSingInNum:0,defaultSingInNum:0,meeting:{},data:[],users:[]}},async mounted(){this.meeting=this.$cookies.get("meeting"),this.meeting.user=this.$cookies.get("user");var e=this;await this.axios({method:"get",url:"api/v1/meeting_history/findCount?mId="+e.meeting.mId,headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?e.count=t.data.data:e.$message(t.data.msg)})),await this.axios({method:"get",url:"api/v1/meeting_history/findNoSingInNum?mId="+e.meeting.mId,headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?(e.noSingInNum=t.data.data,e.singInNum=e.count-e.noSingInNum):e.$message(t.data.msg)})),await this.axios({method:"get",url:"api/v1/meeting_history/findFaceSingInNum?mId="+e.meeting.mId,headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?e.faceSingInNum=t.data.data:e.$message(t.data.msg)})),await this.axios({method:"get",url:"api/v1/meeting_history/findSingInNum?mId="+e.meeting.mId,headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?e.defaultSingInNum=t.data.data:e.$message(t.data.msg)}));var t={name:"人脸签到"};t.value=this.faceSingInNum,this.data.push(t);var a={name:"手动签到"};a.value=this.defaultSingInNum,this.data.push(a),this.create("meetingSingType",this.data,"会议签到方式"),await this.axios({method:"get",url:"api/v1/meeting_history/findJoinUserList?mId="+e.meeting.mId,headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?(console.log(t.data.data),e.users=t.data.data):e.$message(t.data.msg)}))},beforeDestroy(){this.$cookies.remove("meeting")},methods:{getTime(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),r=t.getHours()+"";1==r.length&&(r="0"+r);var n=t.getMinutes()+"";1==n.length&&(n="0"+n);var o=t.getSeconds()+"";return 1==o.length&&(o="0"+o),a+"年"+s+"月"+i+"日 "+r+":"+n+":"+o},create(e,t,a){var s=ve.S1(document.getElementsByClassName(e)[0]);s.setOption({title:{text:a,left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"Access From",type:"pie",radius:"50%",data:t,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}}},$e=_e,Se=(0,u.Z)($e,ke,xe,!1,null,"047791b8",null),Ce=Se.exports,Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticStyle:{height:"100vh"}},[a("el-container",[a("el-header",{staticStyle:{"background-color":"#606266",display:"flex",color:"#F2F6FC","font-size":"14px"}},[a("div",{staticStyle:{"font-size":"20px"}},[e._v("会议签到")]),a("span",{staticStyle:{flex:"1"}}),a("el-dropdown",[a("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px",color:"#F2F6FC"}}),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){e.$router.push("/main/").catch((function(e){}))}}},[e._v("首页")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.goAdmin()}}},[e._v("后台管理")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.$router.push("/main/userInfo").catch((function(e){}))}}},[e._v("个人信息 ")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.logout()}}},[e._v("退出登录")])],1)],1),a("span",[e._v(e._s(e.user.username))])],1),a("el-main",[a("router-tab",{attrs:{"page-transition":"page-fade","tab-transition":"tab-scale","keep-alive":!1,dragsort:!1,tabs:["/admin/"]}})],1)],1)],1)},Te=[],Ne={data(){return{user:""}},methods:{goAdmin(){this.$router.push("/admin").catch((e=>{}))},logout(){this.$cookies.remove("user"),this.$cookies.remove("token"),window.location.href="/#/login"}},mounted(){this.user=this.$cookies.get("user")}},Me=Ne,Fe=(0,u.Z)(Me,Ie,Te,!1,null,"6ffa8f82",null),De=Fe.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{ref:"users",attrs:{data:e.users,"tooltip-effect":"dark",height:e.tableHeight}},[a("el-table-column",{attrs:{prop:"avatar",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.avatar,fit:"cover"}})]}}])}),a("el-table-column",{attrs:{prop:"username",label:"姓名"}}),a("el-table-column",{attrs:{prop:"age",label:"年龄"}}),a("el-table-column",{attrs:{prop:"sex",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(0==t.row.sex?"女":"男"))])]}}])}),a("el-table-column",{attrs:{prop:"phone",label:"手机号","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"address",label:"地址","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"admin",label:"权限"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini"}},[e._v(e._s(0==t.row.admin?"普通用户":"管理员"))])]}}])}),a("el-table-column",{attrs:{prop:"audit",label:"账户审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"mini",type:0==t.row.audit?"":"success"}},[e._v(e._s(0==t.row.audit?"未激活":"已激活")+" ")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini",disabled:t.row.phone==e.$cookies.get("user").phone},on:{click:function(a){return e.deleteUser(t.row.phone)}}},[e._v("删除")]),a("el-button",{attrs:{type:"success",size:"mini",disabled:0!=t.row.audit},on:{click:function(a){return e.activeUser(t.row.phone)}}},[e._v("激活")])]}}])})],1)],1)},ze=[],Ee={data(){return{tableHeight:document.body.clientHeight-140,createMeetingData:{datetime:"",title:"",mId:""},rules:{datetime:{required:!0,message:"请选择会议时间",trigger:"blur"},title:{required:!0,message:"请输入会议名称",trigger:"blur"}},users:[],selectUsers:[]}},async created(){var e=this;window.onresize=function(){e.tableHeight=document.body.clientHeight-140},this.axios({method:"GET",url:"/api/v1/users/findAll",headers:{token:e.$cookies.get("token")}}).then((t=>{200==t.data.code?e.users=t.data.data:(this.$message(t.data.msg),window.location.href="/#/main")}))},methods:{UserSelectionChange(e){this.selectUsers=e},deleteUser(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"error"}).then((()=>{t.axios({method:"post",url:"/api/v1/users/deleteByPhone",headers:{"Content-Type":"multipart/form-data",token:t.$cookies.get("token")},data:{phone:e}}).then((e=>{200==e.data.code?(t.$message("删除成功"),this.$tabs.refresh()):t.$message(e.data.msg)}))})).catch((()=>{}))},activeUser(e){var t=this;this.axios({method:"POST",url:"/api/v1/users/activeUser",headers:{"Content-Type":"multipart/form-data",token:t.$cookies.get("token")},data:{phone:e}}).then((e=>{200==e.data.code?(this.$message("激活成功"),window.location.reload()):this.$message(e.data.msg)}))}},beforePageLeave(e,t){if(""===this.createMeetingData.datetime&&""===this.createMeetingData.title)return;if(1==this.active)return;if("unload"===t)return`您在“${e.title}”页签的更改尚未完成，是否要离开？`;const a={close:"关闭",refresh:"刷新",replace:"替换",leave:"离开"}[t],s=`您确认要${a}页签“${e.title}”吗？`;return new Promise(((e,t)=>{confirm(s)&&(this.$tabs.close(),e())}))}},Be=Ee,Oe=(0,u.Z)(Be,Pe,ze,!1,null,null,null),Ue=Oe.exports,Ae=a(3937),je=a.n(Ae);s["default"].use(m.Z);const Ve=[{path:"/",redirect:"/login"},{path:"/login",component:w},{path:"/register",component:$},{path:"/main",component:M,children:[{path:"/",redirect:"allPanel"},{path:"allPanel",component:ye,meta:{title:"首页"}},{path:"joinMeetings",component:B,meta:{title:"我参与的会议"}},{path:"createMeetings",component:R,meta:{title:"我创建的会议"}},{path:"addMeeting",component:G,meta:{title:"创建会议",keepAlive:!1}},{path:"managerMeeting",component:ee,name:"managerMeeting",meta:{title:"管理会议",keepAlive:!1}},{path:"singInMeeting",component:oe,name:"singInMeeting",meta:{title:"会议签到",keepAlive:!1}},{path:"userInfo",component:he,name:"userInfo",meta:{title:"用户信息",keepAlive:!1}},{path:"statisticalMeeting",component:Ce,name:"statisticalMeeting",meta:{title:"统计",keepAlive:!1}}]},{path:"/admin",component:De,children:[{path:"/",redirect:"userManager"},{path:"userManager",component:Ue,meta:{title:"用户管理"}}]},{path:"/*",redirect:"/main"}],Re=new m.Z({mode:"hash",base:"/",routes:Ve});Re.beforeEach(((e,t,a)=>{a()}));var He=Re,Ze=a(4549),qe=a.n(Ze),Je=a(4901),Le=a.n(Je),Ge=a(6166),Ye=a.n(Ge);s["default"].config.productionTip=!1,s["default"].use(qe()),s["default"].use(je()),s["default"].use(Le()),Ye().defaults.baseURL="",Ye().interceptors.response.use((function(e){return 606==e.data.code&&(window.location.href="/#/login"),e})),s["default"].prototype.axios=Ye(),s["default"].prototype.$tabs=Ae.RouterTabRoutes,new s["default"]({router:He,render:e=>e(c)}).$mount("#app")},4902:function(){},522:function(){},753:function(){}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,s,i,r){if(!s){var n=1/0;for(d=0;d<e.length;d++){s=e[d][0],i=e[d][1],r=e[d][2];for(var o=!0,l=0;l<s.length;l++)(!1&r||n>=r)&&Object.keys(a.O).every((function(e){return a.O[e](s[l])}))?s.splice(l--,1):(o=!1,r<n&&(n=r));if(o){e.splice(d--,1);var u=i();void 0!==u&&(t=u)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[s,i,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,r,n=s[0],o=s[1],l=s[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var d=l(a)}for(t&&t(s);u<n.length;u++)r=n[u],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},s=self["webpackChunksinginv3"]=self["webpackChunksinginv3"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(4e3)}));s=a.O(s)})();